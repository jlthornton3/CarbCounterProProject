<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carb Counter Pro</title>
    <link rel="stylesheet" href="/css/materialize.min.css">
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/css/app.css">
    <script type="text/javascript" src="/js/materialize.min.js"></script>
    <link rel="manifest" href="/manifest.json"> 
</head>

<body class="grey lighten-4">

    <nav class="z-depth-0">
        <div class="nav-wrapper container">
            <a href="/">Carb Counter Pro</a>
            <span class="right grey-text text-darken-1">
                <i class="material-icons sidenav-trigger" data-target="side-menu">menu</i>
            </span>
        </div>
    </nav>
    <ul id="side-menu" class="sidenav side-menu">
        <li><a class="subheader">Carb Counter Pro</a></li>
        <li><a href="/" class="waves-effect">Home</a></li>
        <li><a href="/pages/login.html" class="waves-effect">Login</a></li>
        <li>
            <div class="divider"></div>
        </li>
        <li><a href="/pages/logentry.html" class="waves-effect">Log/View Meals</a></li>
        <li><a href="/pages/feedback.html" class="waves-effect">Feedback</a></li>
        <li><a href="/pages/fooddatabase.html" class="waves-effect">Food Database</a></li>
        <li>
            <div class="divider"></div>
        </li>
        <li><a href="/pages/profile.html" class="waves-effect">Profile</a></li>
        <li><a href="/pages/followers.html" class="waves-effect">Followers</a></li>
        </li>
    </ul>

    <div class="container">
        <div class="section">
            <h3>Food Database</h3>
            <h4>Click + to create a meal entry</h4>
            <div class="collection">
                <ul id="food-list">
            </div>
        </div>
    </div>
<!-- <script type="module" src="/js/db.js"></script> -->   
    <script type="module">   

    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore.js";
    import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-auth.js";


    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
        apiKey: "AIzaSyClNGp515YHGqAhL9LKss72JhLLd2CrpiI",
        authDomain: "carbcounterpro-54c5d.firebaseapp.com",
        projectId: "carbcounterpro-54c5d",
        storageBucket: "carbcounterpro-54c5d.appspot.com",
        messagingSenderId: "775741397142",
        appId: "1:775741397142:web:f55dcf5d0b55d4102c8ab7",
        measurementId: "G-PZH081NWE0"
        };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    

    async function getFoodDb(db) {
    const foodDbCol = collection(db, 'foodDatabase');
    const foodDbSnapshot = await getDocs(foodDbCol);
    const foodList = foodDbSnapshot.docs.map(doc => doc.data());
    return foodList;
    }

    console.log(getFoodDb(db))

        const foodList =document.querySelector('#food-list');

        function renderFoods(dc){
            let li = document.createElement("li");
            let name = document.createElement("span");
            let fat = document.createElement("span");
            let carbs = document.createElement("span");
            let protein = document.createElement("span");
            let size = document.createElement("span");
            let plus = document.createElement('span');

            li.setAttribute('data-id', dc.id);
            name.textContent = dc.data().Name;
            fat.textContent = dc.data().fat;
            carbs.textContent = dc.data().carbs;
            protein.textContent = dc.data().protein;
            size.textContent = dc.data().size;
            plus.textContent = '+';

            li.appendChild(name);
            li.appendChild(fat);
            li.appendChild(carbs);
            li.appendChild(protein);
            li.appendChild(size);
            li.appendChild(plus);

            foodList.appendChild(li);

        }
        const foods = getDocs(collection(db, "foodDatabase")).then((snapshot) => {
            snapshot.forEach((doc) => {
                renderFoods(doc)
            })
        })
    </script>
    <script src="/js/ui.js"></script>
</body>
</html>